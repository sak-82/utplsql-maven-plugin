<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>com.mycompany.utplsql</groupId>
  <artifactId>utplsql-test</artifactId>
  <version>0.0.1-SNAPSHOT</version>
    
   <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <maven.compiler.source>1.8</maven.compiler.source>
        <maven.compiler.target>1.8</maven.compiler.target>
        <junit.platform.version>1.0.3</junit.platform.version>
        <junit.jupiter.version>5.0.3</junit.jupiter.version>
    </properties>
    <dependencies>
    		<dependency>
			<groupId>org.apache.maven.shared</groupId>
			<artifactId>maven-shared-utils</artifactId>
			<version>3.2.0</version>
		</dependency>
		<dependency>
		  	<groupId>com.oracle</groupId>
		  	<artifactId>ojdbc6</artifactId>
		  	<version>11.2.0.1.0</version>
		</dependency>
    </dependencies>
	<repositories>
		<repository>
			<id>utplsql-java-api</id>
			<url>https://packagecloud.io/utplsql/utplsql-java-api/maven2</url>
			<releases>
				<enabled>true</enabled>
			</releases>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</repository>
		<repository>
			<id>repository-snapshots</id>
			<name>repos-Snapshots</name>
			<url>local-repos-url</url>
			<releases>
				<enabled>false</enabled>
			</releases>
			<snapshots>
				<enabled>true</enabled>
			</snapshots>
		</repository> 
	</repositories>
	<pluginRepositories>
	<pluginRepository>
		<id>plugin-releases</id>
		<url>local-plugin-repos-url</url>
		<releases>
			<enabled>true</enabled>
		</releases>
		<snapshots>
			<enabled>false</enabled>
		</snapshots>
	</pluginRepository>
	<pluginRepository>
		<id>plugin-snapshots</id>
		<url>local-plugin-repos-snapshot-url</url>
		<releases>
			<enabled>false</enabled>
		</releases>
		<snapshots>
			<enabled>true</enabled>
		</snapshots>
	</pluginRepository>
	</pluginRepositories>

	<profiles>       
        <profile>
            <id>utPLSQL-maven</id>
            <build>
            <plugins>
				<plugin>
					<groupId>org.codehaus.mojo</groupId>
					<artifactId>properties-maven-plugin</artifactId>
					<version>1.0.0</version>
					<executions>
						<execution>
							<phase>initialize</phase>
							<goals>
								<goal>read-project-properties</goal>
							</goals>
							<configuration>
								<files>
									<file>sonar-project.properties</file>
								</files>
							</configuration>
						</execution>
					</executions>
				</plugin>
				<!--<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-surefire-plugin</artifactId>
					<version>3.0.0-M3</version>
				</plugin> -->
               	<plugin>
					<groupId>org.utplsql</groupId>
					<artifactId>utplsql-maven-plugin</artifactId>
					<version>3.1.0-SNAPSHOT</version>
					<goals>
						<goal>test</goal>
					</goals>
					<configuration>
						<url>${utplsql.url}</url>
						<user>${utplsql.user}</user>
						<password>${utplsql.password}</password>			
						<ignoreFailure>true</ignoreFailure>
						<paths>
							<path>test</path>
						</paths>
						<reporters>
							<reporter>
								<name>UT_SONAR_TEST_REPORTER</name>
								<fileOutput>utplsql/sonar-test-reporter.xml</fileOutput>
								<consoleOutput>true</consoleOutput>
							</reporter>
							<reporter>
								<name>UT_COVERAGE_SONAR_REPORTER</name>
								<fileOutput>utplsql/coverage-sonar-reporter.xml</fileOutput>
								<consoleOutput>true</consoleOutput>
							</reporter>
<!--							<reporter>
								<name>UT_COVERAGE_HTML_REPORTER</name>
								<fileOutput>utplsql/coverage-html-reporter.html</fileOutput>
								<consoleOutput>true</consoleOutput>
							</reporter>
							<reporter>
								<name>UT_XUNIT_REPORTER</name>
								<fileOutput>utplsql/coverage-xunit-reporter.html</fileOutput>
								<consoleOutput>true</consoleOutput>
							</reporter> -->
						</reporters>
						<sources>
							<source>
								<directory>src/packages/</directory>
								<includes>
									<include>**/*.pkg</include>
									<include>**/*.pkb</include>
									<include>**/*.fnc</include>
									<include>**/*.sql</include>
									<include>**/*.SQL</include>
								</includes>
							</source>
						</sources>
						<tests>
							<test>
								<directory>src/test/resources/</directory>
								<includes>
									<include>**/*.pkg</include>
									<include>**/*.pkb</include>
									<include>**/*.pks</include>
									<include>**/*.sql</include>
									<include>**/*.SQL</include>
								</includes>
							</test>
						</tests>
						<!--
						<skipCompatibilityCheck>false</skipCompatibilityCheck>
						<ignoreFailure>true</ignoreFailure>
						-->
						<!-- Custom Source code mapping options. -->
                        <!-- See coverage reporting options in framework documentation. -->
						<sourcesOwner>ut311</sourcesOwner>
                        <!--<sourcesRegexExpression>.*/\w+/(\w+)/(\w+)\.\w{3}</sourcesRegexExpression> -->
						<sourcesRegexExpression>\\((\w+)\.)?(\w+)\.(\w{3})$</sourcesRegexExpression>
                        <sourcesNameSubexpression>2</sourcesNameSubexpression>
                        <sourcesTypeSubexpression>1</sourcesTypeSubexpression>
                        <sourcesCustomTypeMapping>
                                <customTypeMapping>
                                    <type>package body</type>
                                    <customMapping>package_bodies</customMapping>
                                </customTypeMapping>
                        </sourcesCustomTypeMapping>
                        <!-- Custom test code mapping options. -->
                        <!-- See coverage reporting options in framework documentation. -->
                        <testsOwner>ut311</testsOwner>
                        <!-- <testsRegexExpression>.*/\w+/(\w+)/(\w+)\.\w{3}</testsRegexExpression> -->
						<testsRegexExpression>\\((\w+)\.)?(\w+)\.(\w{3})$</testsRegexExpression>
                        <testsNameSubexpression>2</testsNameSubexpression>
                        <testsTypeSubexpression>1</testsTypeSubexpression>
                        <testsCustomTypeMapping>
                            <customTypeMapping>
                                <type>package body</type>
                                <customMapping>package_bodies</customMapping>
                            </customTypeMapping>
                        </testsCustomTypeMapping>
					</configuration>
				</plugin>
             </plugins>
          </build>
       </profile>
    </profiles> 
 </project>